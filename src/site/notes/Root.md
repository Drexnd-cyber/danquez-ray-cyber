---
{"dg-publish":true,"permalink":"/root/"}
---


# Root
``` json
{"theme":"white1","mindData":[[{"id":"7d6d41a7-87cf-cf63","text":"Root","isRoot":true,"main":true,"x":149150,"y":149898,"isExpand":true,"layout":{"layoutName":"mindmap6","direct":"right"},"stroke":"#283593","style":{"background-color":"#283593","color":"#fff","border-color":"#283593","border-width":0,"padding":[15,18,14,18],"font-size":"18","stroke":"#283593"}},{"id":"d77256ce-ade3-d40a","text":"Phishing Emails","stroke":"#283593","style":{"background-color":"#fff","color":"#283593","border-color":"#283593","border-width":0,"padding":[9,14,8,14],"font-size":"14","font-weight":"bold"},"x":149307,"y":149756,"isExpand":false,"layout":null,"pid":"7d6d41a7-87cf-cf63"},{"id":"ba0fc66a-5215-05af","text":"Digital Forensics","stroke":"#283593","style":{"background-color":"#fff","color":"#283593","border-color":"#283593","border-width":0,"padding":[9,14,8,14],"font-size":"14","font-weight":"bold"},"x":149307,"y":149810,"layout":null,"isExpand":false,"pid":"7d6d41a7-87cf-cf63"},{"id":"c4ee9e27-b46b-4fb1","text":"Security Information and Event Monitoring","stroke":"#283593","style":{"background-color":"#fff","color":"#283593","border-color":"#283593","border-width":0,"padding":[9,14,8,14],"font-size":"14","font-weight":"bold"},"x":149307,"y":149951,"layout":null,"isExpand":true,"pid":"7d6d41a7-87cf-cf63"},{"id":"e01e19c2-f52a-49ab","text":"Sub title","stroke":"#283593","style":{"background-color":"#fff","color":"#283593","border-color":"#283593","border-width":0,"padding":[9,14,8,14],"font-size":"14"},"x":149307,"y":150058,"layout":null,"isExpand":true,"pid":"7d6d41a7-87cf-cf63"},{"id":"294d04a4-67c0-2d66","text":"Retrieve an original copy of the phishing email","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12","font-weight":"bold"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"d77256ce-ade3-d40a"},{"id":"ac7a9943-d848-fdda","text":"Gather Artifacts from the phishing email","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12","font-weight":"bold"},"x":10,"y":-76813,"layout":null,"isExpand":false,"pid":"d77256ce-ade3-d40a"},{"id":"3b9386e1-8891-8142","text":"Inform the recipients that received the email","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12","font-weight":"bold"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"d77256ce-ade3-d40a"},{"id":"74bda6e0-a567-9553","text":"Analyze artifacts to collect IOC's","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12","font-weight":"bold"},"x":10,"y":-76813,"layout":null,"isExpand":false,"pid":"d77256ce-ade3-d40a"},{"id":"fe47880c-a8b5-e38c","text":"Implement reactive measures then ensure you took note of all possible defensive and preventative measures","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12","font-weight":"bold"},"x":10,"y":-76813,"layout":null,"isExpand":false,"pid":"d77256ce-ade3-d40a"},{"id":"90a0e143-dbed-79dc","text":"Document all steps taken","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12","font-weight":"bold"},"x":10,"y":-76813,"layout":null,"isExpand":false,"pid":"d77256ce-ade3-d40a"},{"id":"fc66b256-0408-ef40","text":"File Hashing (Windows, Linux)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12","font-weight":"bold"},"x":10,"y":-76813,"layout":null,"isExpand":false,"pid":"ba0fc66a-5215-05af"},{"id":"46b790b6-35cf-8a36","text":"Metadata extraction (Windows, Linux)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12","font-weight":"bold"},"x":10,"y":-76813,"layout":{"layoutName":"mindmap2","direct":"right"},"isExpand":false,"pid":"ba0fc66a-5215-05af","main":false},{"id":"3966ebeb-eecc-0030","text":"Identifying File Systems and Hard Drive Imaging w/ FTK Imager","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12","font-weight":"bold"},"x":10,"y":-76813,"layout":null,"isExpand":false,"pid":"ba0fc66a-5215-05af"},{"id":"0813ced9-2a73-5aaa","text":"Dumping Memory (RAM)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12","font-weight":"bold"},"x":10,"y":-76813,"layout":null,"isExpand":false,"pid":"ba0fc66a-5215-05af"},{"id":"b4132d9f-335b-735e","text":"Windows Investigations","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12","font-weight":"bold"},"x":10,"y":-76813,"layout":null,"isExpand":false,"pid":"ba0fc66a-5215-05af"},{"id":"cb1fbbff-031d-73ab","text":"Linux Investigations","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12","font-weight":"bold"},"x":10,"y":-76813,"layout":null,"isExpand":false,"pid":"ba0fc66a-5215-05af"},{"id":"479d51bd-8abc-b399","text":"Memory (RAM) Analysis with Volatility\n[[SOC/Digital Forensic Notes/Digital Forensics#Volatility\|SOC/Digital Forensic Notes/Digital Forensics#Volatility]]","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12","font-weight":"bold"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"ba0fc66a-5215-05af"},{"id":"468ea24a-7d9f-43cd","text":"Disk Analysis with Autopsy","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12","font-weight":"bold"},"x":10,"y":-76813,"layout":null,"isExpand":false,"pid":"ba0fc66a-5215-05af"},{"id":"74ef5902-4693-8cb9","text":"Windows Logs","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":149651,"y":149889,"isExpand":true,"layout":null,"pid":"c4ee9e27-b46b-4fb1"},{"id":"7303bce4-bfa3-e693","text":"Sysmon Logs","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":149651,"y":149939,"layout":null,"isExpand":true,"pid":"c4ee9e27-b46b-4fb1"},{"id":"1e0ee6c8-de16-5c13","text":"syslog\nshutdowns, start-ups, processes, and connections.","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":149651,"y":149971,"layout":null,"isExpand":false,"pid":"c4ee9e27-b46b-4fb1"},{"id":"11c3533b-e369-7aa7","text":"Splunk","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":149651,"y":150014,"layout":null,"isExpand":true,"pid":"c4ee9e27-b46b-4fb1"},{"id":"94e31d63-f228-ec6f","text":"Email Client Extraction","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"isExpand":false,"layout":null,"pid":"ac7a9943-d848-fdda"},{"id":"57273714-1811-208a","text":"Text Editor Extraction (Sublime)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"isExpand":false,"layout":null,"pid":"ac7a9943-d848-fdda"},{"id":"da69ff43-fd5e-42d4","text":"URL","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"isExpand":false,"layout":null,"pid":"74bda6e0-a567-9553"},{"id":"b70ee5ed-4a45-e905","text":"Attachment(s) / Malware","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"isExpand":false,"layout":null,"pid":"74bda6e0-a567-9553"},{"id":"cdabc236-067b-ca1e","text":"Protection your Domain from Spoofing - Sender Policy Framework (SPF)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"isExpand":false,"layout":null,"pid":"fe47880c-a8b5-e38c"},{"id":"e322844c-ad7b-1ec9","text":"Domain Keys Identified Mail (DKIM)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"isExpand":false,"layout":null,"pid":"fe47880c-a8b5-e38c"},{"id":"8b429c4a-367e-de04","text":"Domain-based Message Authentication","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"isExpand":false,"layout":null,"pid":"fe47880c-a8b5-e38c"},{"id":"c39b4971-0a05-c9db","text":"Blocking Email Artifacts","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"isExpand":false,"layout":null,"pid":"fe47880c-a8b5-e38c"},{"id":"c460294d-5312-581e","text":"Blocking Web Artifacts","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"isExpand":false,"layout":null,"pid":"fe47880c-a8b5-e38c"},{"id":"e322decd-d0a4-58ea","text":"Refer to [[SOC/Notes/Today Note/Write/Report Writing#Basic Report Writing Template\|Report Writing#Basic Report Writing Template]]","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"90a0e143-dbed-79dc"},{"id":"72f8bf33-7cdc-95fd","text":"Refer to [[SOC/Notes/3-3-2025/SHA256 Hash Value\|SOC/Notes/3-3-2025/SHA256 Hash Value]]","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"fc66b256-0408-ef40"},{"id":"b4f2a4a5-e62b-c844","text":"Windows and Linux GUI","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"46b790b6-35cf-8a36","note":"Right click on file, select properties, then go to the detail tab. This is the metadata\n![Pasted image 20250228094921.png](/img/user/SOC/Notes/Pasted%20image%2020250228094921.png)"},{"id":"2d10afa6-9d63-f9c4","text":"Linux no GUI","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"46b790b6-35cf-8a36","note":"**No GUI is present**:\n```\nls -lisap <file>\n```\n```\nstat <file>\n```\n![Pasted image 20250228095311.png](/img/user/SOC/Notes/Pasted%20image%2020250228095311.png)\n\n**On Kali Linux exiftool is available:**\n\nIf it is not found:\n```\nsudo apt-get install exiftool\n```\n![Pasted image 20250228095455.png](/img/user/SOC/Notes/Pasted%20image%2020250228095455.png)\n\n```\nexiftool <filename>\n```\n![79ab7a938d106d52b2508d6bae5b1198cc50020e9cead577667fdd581bbb08db615e58f9e4d10d2014a400896c6a.gif](/img/user/SOC/Notes/79ab7a938d106d52b2508d6bae5b1198cc50020e9cead577667fdd581bbb08db615e58f9e4d10d2014a400896c6a.gif)"},{"id":"485105ea-18d6-e3cc","text":"Identifying file systems w/ FTK Imager","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"3966ebeb-eecc-0030","note":"## Identifying File Systems\n![Pasted image 20250228093549.png](/img/user/SOC/Notes/Pasted%20image%2020250228093549.png)\n\nWe need to click on File > Add Evidence Item.\n![Pasted image 20250228093559.png](/img/user/SOC/Notes/Pasted%20image%2020250228093559.png)\n\nWhen asked for the source evidence type, we want to select Image File.\n![Pasted image 20250228093610.png](/img/user/SOC/Notes/Pasted%20image%2020250228093610.png)\n\nWe’re going to open the file disk2.img, then click Finish.\n![Pasted image 20250228093622.png](/img/user/SOC/Notes/Pasted%20image%2020250228093622.png)\n\nThe below GIF shows how you can identify the file system using FTK Imager. The system this image file was taken from is using NTFS.\n![9a37608cc6df9c5c5a2bcae4b6d40d9eb0a635ab175f3872f981f14e49aa6b7c25a2cdb11c680e603875f21e3ca6.gif](/img/user/SOC/Notes/9a37608cc6df9c5c5a2bcae4b6d40d9eb0a635ab175f3872f981f14e49aa6b7c25a2cdb11c680e603875f21e3ca6.gif)"},{"id":"db821385-3ad3-a8f8","text":"Hard Drive Imaging","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"note":"Within FTK Imager, we want to click on **File**, then go to **Create Disk Image**.\n![Pasted image 20250228110413.png](/img/user/SOC/Notes/Pasted%20image%2020250228110413.png)\n\nNext FTK Imager will ask us what the source of the evidence will be. As we are taking a copy of the data from a USB drive, we need to select **Physical Drive**.\n![Pasted image 20250228110446.png](/img/user/SOC/Notes/Pasted%20image%2020250228110446.png)\n\nAs we have selected Physical Drive, FTK Imager will now ask us to select which of the drives are currently attached to the system running the tool. In the drop-down, you can see the 500GB SSD, and the 15GB USB. We need to select the USB drive.\n![Pasted image 20250228110555.png](/img/user/SOC/Notes/Pasted%20image%2020250228110555.png)\n\nClick **Next** unless you are in a real-world environment  \n![Pasted image 20250228110624.png](/img/user/SOC/Notes/Pasted%20image%2020250228110624.png)\n\nNow we have to assign an output destination, and the file name we want our disk image to have when exported from FTK Imager. We want the `.img` file to be named USBImage.img, and be placed on our Desktop. We also want to set the Image Fragment Size to 0MB – this means that the disk image won’t be split into smaller segments, as we want it all in one file.\n![Pasted image 20250228110737.png](/img/user/SOC/Notes/Pasted%20image%2020250228110737.png)\n\nAfter we click Finish FTK Imager will get to work, copying over every single bit of data from the USB to our hard drive.\n![Pasted image 20250228110758.png](/img/user/SOC/Notes/Pasted%20image%2020250228110758.png)\n\nOnce FTK Imager has finished taking the copy, the below window will popup, comparing file hashes to ensure that the copy is forensically sound.\n![Pasted image 20250228110847.png](/img/user/SOC/Notes/Pasted%20image%2020250228110847.png)","layout":null,"isExpand":true,"pid":"3966ebeb-eecc-0030"},{"id":"d7dac244-b682-f9d4","text":"FTK Imager\n**Its better to use kape so you can take a hard Drive Image with FTK Imager and at the same time dump memory with kape.**","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"note":"![Pasted image 20250228110032.png](/img/user/SOC/Notes/Pasted%20image%2020250228110032.png)\n\nSnapshot of RAM **File > Capture Memory**\n![Pasted image 20250228110104.png](/img/user/SOC/Notes/Pasted%20image%2020250228110104.png)\n\nLeave both of those options unchecked, and click “Capture Memory”. FTK Imager will now get to work dumping everything from the RAM, and storing it in a .mem file.\n![Pasted image 20250228110225.png](/img/user/SOC/Notes/Pasted%20image%2020250228110225.png)\nWe can use tools such as Volatility to analyze this dump.","main":false,"layout":{"layoutName":"mindmap2","direct":"right"},"isExpand":true,"pid":"0813ced9-2a73-5aaa"},{"id":"c3d9d982-344c-e440","text":"Kape\n[[SOC/Digital Forensic Notes/Digital Forensics#Live Forensics W/ KAPE\|SOC/Digital Forensic Notes/Digital Forensics#Live Forensics W/ KAPE]]","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"0813ced9-2a73-5aaa"},{"id":"9f6a545b-d765-e89e","text":"Single process with PowerShell\n(Should be used for malware)\n[[SOC/Digital Forensic Notes/Digital Forensics#Powershell process memory dump\|SOC/Digital Forensic Notes/Digital Forensics#Powershell process memory dump]]","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"0813ced9-2a73-5aaa"},{"id":"934af31d-5e82-9d62","text":"Tracing Executables and Associated Files","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"isExpand":false,"main":false,"layout":null,"pid":"b4132d9f-335b-735e"},{"id":"4f24c074-5a24-1a33","text":"Browser Capture and Viewer","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":false,"pid":"b4132d9f-335b-735e"},{"id":"4d70682c-64ae-9ce8","text":"Logon Events","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":false,"pid":"b4132d9f-335b-735e"},{"id":"60413a4d-89d9-aa3e","text":"Recycle Bin Metadata Recovery\n[[SOC/Digital Forensic Notes/Digital Forensics#Recycle Bin Metadata recovery\|SOC/Digital Forensic Notes/Digital Forensics#Recycle Bin Metadata recovery]]","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"b4132d9f-335b-735e"},{"id":"44c44ba1-ac87-191f","text":"Users and Passwords (/etc/passwd and /etc/shadow)\n[[SOC/Digital Forensic Notes/Digital Forensics#Passwd and Shadow\|SOC/Digital Forensic Notes/Digital Forensics#Passwd and Shadow]]","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"isExpand":true,"layout":null,"pid":"cb1fbbff-031d-73ab"},{"id":"894d3a9c-c231-48de","text":"Currently installed software packages (/var/lib)\n[[SOC/Digital Forensic Notes/Digital Forensics#var/lib\|SOC/Digital Forensic Notes/Digital Forensics#var/lib]]","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"isExpand":true,"layout":null,"pid":"cb1fbbff-031d-73ab"},{"id":"ceac4627-94c6-528b","text":"Operating System and Web Server Logs (/var/log)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":false,"pid":"cb1fbbff-031d-73ab"},{"id":"49f6fd51-54d3-ac16","text":"User Files","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"isExpand":false,"layout":null,"pid":"cb1fbbff-031d-73ab"},{"id":"976bfa32-8480-fa30","text":"Memory Dump\n[[SOC/Digital Forensic Notes/Digital Forensics#Memory\|SOC/Digital Forensic Notes/Digital Forensics#Memory]]","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"cb1fbbff-031d-73ab"},{"id":"a08c0c26-9362-457f","text":"Setup\n[[SOC/Autopsy#Setup\|Autopsy#Setup]]","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"468ea24a-7d9f-43cd"},{"id":"6efc0a88-7288-9dcb","text":"Analyzing Ingest Module Results","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"468ea24a-7d9f-43cd"},{"id":"0ee021ff-1865-3e84","text":"Security Logs\n[[SOC/Digital Forensic Notes/Event log locations\|Event log locations]]","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":149776,"y":149864,"isExpand":false,"layout":null,"pid":"74ef5902-4693-8cb9","note":"Events that are relevant to the security of the system (Logins and logouts, file deletion, granting of administration permissions, etc.)"},{"id":"31501cfb-da3e-9c0b","text":"System","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":149776,"y":149907,"note":"System: Events logged by the Operating System (Device loading, startup errors, etc.)","layout":null,"isExpand":false,"pid":"74ef5902-4693-8cb9"},{"id":"0626f76d-d8ed-2604","text":"syslog message explanation\n[[SOC/Digital Forensic Notes/syslog message\|syslog message]]","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":62785.5,"layout":null,"isExpand":true,"pid":"1e0ee6c8-de16-5c13"},{"id":"dbf02f17-ca8e-24d6","text":"Sender Email Address","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"94e31d63-f228-ec6f"},{"id":"9ae51b88-7195-0750","text":"Subject Line","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"94e31d63-f228-ec6f"},{"id":"bee1c3ac-0ca7-4fae","text":"Recipient Email Addresses (Unless they're Blind Carbon Copy (BCC))","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"94e31d63-f228-ec6f"},{"id":"c1febe46-6d0b-5199","text":"Date & Time","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"94e31d63-f228-ec6f"},{"id":"de844157-e781-6a4b","text":"Sending Server IP","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":false,"pid":"57273714-1811-208a"},{"id":"c5869485-d5a0-49a4","text":"Reply to Address","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":false,"pid":"57273714-1811-208a"},{"id":"abd29003-d752-e6d0","text":"File Artifacts","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"isExpand":false,"layout":null,"pid":"57273714-1811-208a"},{"id":"ed4217c3-dd55-312d","text":"Web Artifacts","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":false,"pid":"57273714-1811-208a"},{"id":"a57130f4-6901-d57c","text":"URL Visualization - https://www.url2png.com/#testdrive","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"da69ff43-fd5e-42d4"},{"id":"686efc67-f389-764d","text":"URL Reputation - https://www.virustotal.com/gui/home/url","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"da69ff43-fd5e-42d4"},{"id":"5ae1f6eb-6aec-edaf","text":"Threat Feed - https://urlhaus.abuse.ch/verify-ua/ or https://www.phishtank.com/","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"da69ff43-fd5e-42d4"},{"id":"9b074dca-16f4-a71f","text":"File Reputation - https://www.virustotal.com/gui/home/upload or https://talosintelligence.com/talos_file_reputation","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"b70ee5ed-4a45-e905"},{"id":"9c9d27a2-b205-5c83","text":"Automate Malware Analysis - https://www.hybrid-analysis.com/#homepage-file-collection","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"b70ee5ed-4a45-e905"},{"id":"2dd50292-8a25-6e91","text":"> [!important] Protecting Your Domain from Spoofing\n> The DNS (TXT) record Sender Policy Framework (SPF) can be used to to prevent a malicious actor from spoofing your domain.\n> \n> Syntax of SPF:\n> ```\n> v=spf1 <IP> <enforcement rule>\n>```\n> Example:\n>```\n>v=spf1 a: include:mailgun.org protection.outlook.com -all\n>```","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"cdabc236-067b-ca1e"},{"id":"784c3ee0-9a1d-d1cb","text":"> [!important] Domain Keys Identified Mail (DKIM)\n> Domain Keys Identified Mail (DKIM) is a method of email authentication that cryptographically verifies if an email has been sent by its trusted servers and hasn’t been tampered with during transmission.","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"e322844c-ad7b-1ec9"},{"id":"778c9f72-caa3-d6cb","text":"> [!important] DMARC specify what happens if both SPF and DMARC checks are failed\n> Domain-based Message Authentication, Reporting & Conformance can be used to specify what happens when both SPF and DKIM checks are failed.\n> The three basic options is none, quarantine, and reject\n> \n> Syntax:\n> ```\n> v=DMARC1 <action> <report address>\n>```\n>\n>Example:\n>```\n>v=DMARC1; p=quarantine; rua=mailto:contact@securityblue.team\n>```","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"8b429c4a-367e-de04"},{"id":"de660639-c959-82b5","text":"> [!important] Blocking Email Artifacts\n> You can block the following email artifacts:\n> - Email Sender \n> - Sender Domain (block the entire sending domain if necessary)\n> - Sender Server IP\n> - Subject Line","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"c39b4971-0a05-c9db"},{"id":"d39414d4-dcde-3196","text":"URL Blocks","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"c460294d-5312-581e"},{"id":"2029d2f4-8cd3-7fdf","text":"LNK Files / Shortcut Analysis\n[[SOC/Digital Forensic Notes/Digital Forensics#LNK Files / Shortcut Analysis\|SOC/Digital Forensic Notes/Digital Forensics#LNK Files / Shortcut Analysis]]","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"934af31d-5e82-9d62"},{"id":"07967149-2dc8-01a6","text":"**Prefetch Files** - Path to the executable file, when the program was last run, and when the program was created/installed.\n[[SOC/Digital Forensic Notes/Digital Forensics#Prefetch Files\|SOC/Digital Forensic Notes/Digital Forensics#Prefetch Files]]","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"934af31d-5e82-9d62"},{"id":"e4891168-9a26-0fa4","text":"**Jump List** - Contain information about applications that are pinned to the taskbar, such as the file path, timestamps, and application identifiers (AppIDs).\n[[SOC/Digital Forensic Notes/Digital Forensics#Jump List\|SOC/Digital Forensic Notes/Digital Forensics#Jump List]]","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"934af31d-5e82-9d62"},{"id":"15c0be25-5c5f-4b72","text":"Browser Capture w/ KAPE","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"4f24c074-5a24-1a33"},{"id":"8c628b56-ff83-bb93","text":"Browser Capture w/ Browser History Capture\nhttps://www.foxtonforensics.com/browser-history-capturer/","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"4f24c074-5a24-1a33"},{"id":"d8373ca9-98f9-57b6","text":"Browser Viewer w/ Browser History Viewer\n[[SOC/Digital Forensic Notes/Digital Forensics#Browser History Viewer\|SOC/Digital Forensic Notes/Digital Forensics#Browser History Viewer]]","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"4f24c074-5a24-1a33"},{"id":"1309bb38-f92e-77a2","text":"Sysmon ID","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"4d70682c-64ae-9ce8"},{"id":"7d640dda-4b79-3e0d","text":"Event IDs","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"isExpand":true,"layout":null,"pid":"4d70682c-64ae-9ce8"},{"id":"15656c8e-f65f-4a85","text":"Operating System Logs\n[[SOC/Digital Forensic Notes/Digital Forensics#var/log\|SOC/Digital Forensic Notes/Digital Forensics#var/log]]","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"ceac4627-94c6-528b"},{"id":"04d0ca45-9518-fb62","text":"Web Server Logs\n[[SOC/Digital Forensic Notes/Digital Forensics#Web Server Logs\|SOC/Digital Forensic Notes/Digital Forensics#Web Server Logs]]","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"ceac4627-94c6-528b"},{"id":"303acd45-de5d-8a5a","text":".bash_history\n[[SOC/Digital Forensic Notes/Digital Forensics#Bash History\|SOC/Digital Forensic Notes/Digital Forensics#Bash History]]","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"49f6fd51-54d3-ac16"},{"id":"c540ce9d-0f6a-368f","text":"Hidden files and directories\nTo view hidden files:\n```\nls -a\n```","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"49f6fd51-54d3-ac16"},{"id":"986210f4-9d38-ad6a","text":"Clear files and directories","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"note":"    A user’s desktop\n    A user’s default directories, including; Downloads, Music, Pictures, Public, Templates, Videos\n    The Trash Bin","layout":null,"isExpand":true,"pid":"49f6fd51-54d3-ac16"},{"id":"94467738-74d4-3306","text":"Steganography\n[[SOC/Digital Forensic Notes/Digital Forensics#Steganography\|SOC/Digital Forensic Notes/Digital Forensics#Steganography]]","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"49f6fd51-54d3-ac16"},{"id":"f011c1aa-653e-80ed","text":"[[4634\|4634]] (Logoff)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"isExpand":true,"layout":null,"pid":"0ee021ff-1865-3e84","note":""},{"id":"79e403fa-805f-653e","text":"4625 (Failed Logon)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"isExpand":true,"layout":null,"pid":"0ee021ff-1865-3e84","note":"**Take note of error code**\n\n| NETLOGON LOG ERROR CODE | DESCRIPTION |\n| ----------------------- | ------------------------------------------------------------------------------ |\n| 0xC0000064 | The specified user does not exist |\n| 0xC000006A | The value provided as the current password is not correct |\n| 0xC000006C | Password policy not met |\n| 0xC000006D | The attempted logon is invalid due to a bad user name |\n| 0xC000006E | User account restriction has prevented successful login |\n| 0xC000006F | The user account has time restrictions and may not be logged onto at this time |\n| 0xC0000070 | The user is restricted and may not log on from the source workstation |\n| 0xC0000071 | The user account’s password has expired |\n| 0xC0000072 | The user account is currently disabled |\n| 0xC000009A | Insufficient system resources |\n| 0xC0000193 | The user’s account has expired |\n| 0xC0000224 | User must change his password before he logs on the first time |\n| 0xC0000234 | The user account has been automatically locked |"},{"id":"0a61536a-3e02-fdb9","text":"[[4624\|4624]] (Successful Logon)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"isExpand":true,"layout":null,"pid":"0ee021ff-1865-3e84","note":""},{"id":"2d597e52-15fa-bdbc","text":"4672 (Special Privileges Assigned to a New Logon)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"isExpand":true,"layout":null,"pid":"0ee021ff-1865-3e84","note":"This event is logged whenever an account logs on with super user privileges. Tracking these events helps to ensure that super user privileges are not being abused or used maliciously."},{"id":"24ee4c5a-395f-2afe","text":"5379 (Credential Manager Credentials were read)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"layout":null,"isExpand":true,"pid":"0ee021ff-1865-3e84"},{"id":"852ede9b-f7d1-8071","text":"4771 (Kerberos pre-authentication failed)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"note":"This event is similar to 4625 (failed logon) but specifically for Kerberos authentication. An unusual amount of these logs could indicate an attacker attempting to brute force your Kerberos service.","main":false,"layout":{"layoutName":"mindmap2","direct":"right"},"isExpand":true,"pid":"0ee021ff-1865-3e84"},{"id":"5a8f092d-31c5-1785","text":"4776 (The domain controller attempted to validate the credentials for an account)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"note":"This event helps track both successful and failed attempts at credential validation by the domain controller. Multiple failures could suggest a brute-force attack.","layout":null,"isExpand":true,"pid":"0ee021ff-1865-3e84"},{"id":"89fa996d-9c89-c106","text":"4720 (A user account was created)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"layout":null,"isExpand":true,"pid":"0ee021ff-1865-3e84"},{"id":"be14b97e-670c-fb79","text":"4732 (A member was added to a security-enabled local group)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"layout":null,"isExpand":true,"pid":"0ee021ff-1865-3e84"},{"id":"44e33828-d211-730a","text":"4698 (A scheduled task was created)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"note":"This event is triggered when a scheduled task is created. Monitoring this event can help you detect persistence mechanisms, as attackers often use scheduled tasks to maintain access and run malicious code.","layout":null,"isExpand":true,"pid":"0ee021ff-1865-3e84"},{"id":"ba1b1365-a296-de7a","text":"4719 (System audit policy was changed)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"note":"This event records changes to the audit policy on a computer. It could be a sign that someone is trying to cover their tracks by turning off auditing or changing what events get audited.","layout":null,"isExpand":true,"pid":"0ee021ff-1865-3e84"},{"id":"e987bea7-0cba-1b93","text":"4700 & 4701 (A scheduled task was enabled/disabled)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"note":"This records the enabling or disabling of a scheduled task. Scheduled tasks are often manipulated by attackers for persistence or to run malicious code, thus these logs can provide valuable insight into suspicious activities.","layout":null,"isExpand":true,"pid":"0ee021ff-1865-3e84"},{"id":"80c30d87-c12c-bb26","text":"4702 (A scheduled task was updated)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"note":"Similar to 4698, this event is triggered when a scheduled task is updated. Monitoring these updates can help detect changes that may signify malicious intent.","layout":null,"isExpand":true,"pid":"0ee021ff-1865-3e84"},{"id":"887bfb1f-5daa-2140","text":"1102 (The audit log was cleared)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"note":"Clearing the audit log is often a sign of an attempt to remove evidence of an intrusion or malicious activity.","layout":null,"isExpand":true,"pid":"0ee021ff-1865-3e84"},{"id":"97230258-36c3-d89e","text":"5001 (Antivirus real-time protection configuration has changed)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"note":"This event indicates that the real-time protection settings of Defender have been modified. Unauthorized changes could indicate an attempt to disable or undermine the functionality of Defender.","layout":null,"isExpand":true,"pid":"0ee021ff-1865-3e84"},{"id":"8c1ba57e-a59b-8047","text":"4648 (A logon was attempted using explicit credentials)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"layout":null,"isExpand":true,"pid":"0ee021ff-1865-3e84","note":"This event is triggered when a user logs on with explicit credentials to run a program. Anomalies in these logon events could indicate lateral movement within a network, which is a common technique used by attackers."},{"id":"a3010bce-3489-04a5","text":"4656 (A handle to an object was requested)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"layout":null,"isExpand":true,"pid":"0ee021ff-1865-3e84","note":"This event is triggered when a handle to an object (like a file, registry key, or process) is requested. This can be a useful event for detecting attempts to access sensitive resources."},{"id":"8c4ccc96-d1d1-bdbf","text":"5140 (A network share object was accessed)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"note":"This event is logged whenever a network share is accessed. This can be critical in identifying unauthorized access to network shares.","layout":null,"isExpand":true,"pid":"0ee021ff-1865-3e84"},{"id":"3d5e6901-3513-0eda","text":"4738 (A user account was changed)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"note":"This event records any changes made to user accounts, including changes to privileges, group memberships, and account settings. Unexpected account changes can be a sign of account takeover or insider threats.","layout":null,"isExpand":true,"pid":"0ee021ff-1865-3e84"},{"id":"80245d58-4637-cd24","text":"5142 (A network share object was added)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"note":"This event signifies the creation of a new network share. Unauthorized network shares could be used to exfiltrate data or spread malware across a network.","layout":null,"isExpand":true,"pid":"0ee021ff-1865-3e84"},{"id":"cba48793-fa68-3d2a","text":"5145 (A network share object was checked to see whether client can be granted desired access)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"note":"This event indicates that someone attempted to access a network share. Frequent checks of this sort might indicate a user or a malware trying to map out the network shares for future exploits.","layout":null,"isExpand":true,"pid":"0ee021ff-1865-3e84"},{"id":"543fd1af-40de-b665","text":"5157 (The Windows Filtering Platform has blocked a connection)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"layout":null,"isExpand":true,"pid":"0ee021ff-1865-3e84"},{"id":"5a17ad15-c281-0e3e","text":"1116 (Antivirus malware detection)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"note":"This event is particularly important because it logs when Defender detects a malware. A surge in these events could indicate a targeted attack or widespread malware infection.","isExpand":false,"layout":null,"pid":"0ee021ff-1865-3e84"},{"id":"4e653cfb-0a47-03ab","text":"7045 (A service was installed in the system)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-534,"note":"A sudden appearance of unknown services might suggest malware installation, as many types of malware install themselves as services.","layout":null,"isExpand":true,"pid":"0ee021ff-1865-3e84"},{"id":"6d8cd7e2-5e6e-ca22","text":"1074 (System Shutdown/Restart)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-2,"note":"This event log indicates when and why the system was shut down or restarted. By monitoring these events, you can determine if there are unexpected shutdowns or restarts, potentially revealing malicious activity such as malware infection or unauthorized user access.","layout":null,"isExpand":true,"pid":"31501cfb-da3e-9c0b"},{"id":"5d5f4e32-e1c0-7d53","text":"6005 (The Event log service was started)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-2,"note":"This event log marks the time when the Event Log Service was started. This is an important record, as it can signify a system boot-up, providing a starting point for investigating system performance or potential security incidents around that period. It can also be used to detect unauthorized system reboots.","layout":null,"isExpand":true,"pid":"31501cfb-da3e-9c0b"},{"id":"88889b8e-8d6a-e962","text":"6006 (The event log service was stopped)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-2,"note":"This event log signifies the moment when the Event Log Service was stopped. It is typically seen when the system is shutting down. Abnormal or unexpected occurrences of this event could point to intentional service disruption for covering illicit activities.","layout":null,"isExpand":true,"pid":"31501cfb-da3e-9c0b"},{"id":"63171d1b-67d9-ace5","text":"6013 (Windows uptime)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-2,"note":"This event occurs once a day and shows the uptime of the system in seconds. A shorter than expected uptime could mean the system has been rebooted, which could signify a potential intrusion or unauthorized activities on the system.","layout":null,"isExpand":true,"pid":"31501cfb-da3e-9c0b"},{"id":"8f0957f2-301c-2737","text":"7040 (Service status change)","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-2,"note":"This event indicates a change in service startup type, which could be from manual to automatic or vice versa. If a crucial service's startup type is changed, it could be a sign of system tampering.","layout":null,"isExpand":true,"pid":"31501cfb-da3e-9c0b"},{"id":"11132cbb-32cb-3a35","text":"To identify whether the phishing email was spoofed.\nIn text editor CTRL + F **X-Sender-IP**\nAfter go to [[SOC/Notes/3-3-2025/Sending Server IP & Reverse DNS\|SOC/Notes/3-3-2025/Sending Server IP & Reverse DNS]] to get instructions\nfor performing a reverse DNS lookup","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"de844157-e781-6a4b"},{"id":"6512e7d8-c631-94b0","text":"If **reply to address** is not the same as **sender email address** the **attacker spoofed the sender email address**.\nIn text editor CTRL + F **reply**","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"c5869485-d5a0-49a4"},{"id":"50e3e304-aae5-eae9","text":"Get attachment name and extension\nIn text editor CTRL + F **filename**","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"abd29003-d752-e6d0"},{"id":"e7ba0e9e-15e7-50d7","text":"Get attachment from email without executing it","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"abd29003-d752-e6d0"},{"id":"1db6760d-cfde-876d","text":"Compute the sha256, sha1, and md5 hash of the attachment\n[[SOC/Notes/3-3-2025/SHA256 Hash Value\|SOC/Notes/3-3-2025/SHA256 Hash Value]]","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"abd29003-d752-e6d0"},{"id":"db93939b-e51b-6e58","text":"On text editor the three quickest ways to\nfind URL(s) is [[SOC/Notes/Today Note/Full URLs\|SOC/Notes/Today Note/Full URLs]]","stroke":"#283593","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":-76813,"layout":null,"isExpand":true,"pid":"ed4217c3-dd55-312d"},{"id":"43a4ebbe-0f3c-6279","text":"1118 (Antivirus remediation activity has started)","stroke":"","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":2055,"note":"This event signifies that Defender has begun the process of removing or quarantining detected malware. It's important to monitor these events to ensure that remediation activities are successful.","isExpand":false,"layout":null,"pid":"5a17ad15-c281-0e3e"},{"id":"ba6d70b8-bfd4-c0f5","text":"1119 (Antivirus remediation activity has succeeded)","stroke":"","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":2055,"note":"This event signifies that the remediation process for detected malware has been successful. Regular monitoring of these events will help ensure that identified threats are effectively neutralized.","layout":null,"isExpand":true,"pid":"43a4ebbe-0f3c-6279"},{"id":"3bd342ec-56b6-8575","text":"1120 (Antivirus remediation activity has failed)","stroke":"","style":{"background-color":"#D7CCC8","color":"#283593","border-color":"transparent","border-width":0,"padding":[5,8,4,8],"font-size":"12"},"x":10,"y":2055,"note":"This event is the counterpart to 1119 and indicates that the remediation process has failed. These events should be closely monitored and addressed immediately to ensure threats are effectively","layout":null,"isExpand":true,"pid":"43a4ebbe-0f3c-6279"}],[{"text":"
<div class="transclusion internal-embed is-loaded"><div class="markdown-embed">



1. **Retrieve an original copy of the phishing email**
2. [[SOC/Notes/Phishing Emails and Artifact Analysis#2. Gather artifacts from the phishing email\|Gather Artifacts from the phishing email]]
3. **Inform the recipients that received the email**
4. [[SOC/Notes/Phishing Emails and Artifact Analysis#4. Investigate malicious artifacts to collect indicators of compromise that can be blocked to protect the organization\|Investigate malicious artifacts to collect indicators of compromise that can be blocked to protect the organization]] 
5. [[SOC/Notes/Phishing Emails and Artifact Analysis#5. Taking Defensive Actions\|Take Defensive Actions]]
6. [[SOC/Notes/Phishing Emails and Artifact Analysis#6. Complete the investigation report, documenting all of the above steps\|Complete the investigation report, documenting all of the above steps]]

# 2. Gather artifacts from the phishing email

>[!Important]
>The first thing that should be done to prevent phishing attacks is user awareness training.
>
>When a organization is mature enough they can start [[SOC/Notes/3-3-2025/Simulating Phishing Attacks\|Simulating Phishing Attacks]]
## Email Client Extraction

> [!important] Preventative / Defensive Measure
> If the email is not marked as external at this step then a Preventative/Defensive Measure will be to ensure all external emails should be marked as external using [[SOC/Notes/Today Note/Write/Defensive Measures#How to mark External Emails GUI\|SOC/Notes/Today Note/Write/Defensive Measures#How to mark External Emails GUI]]

- [ ] [[SOC/Notes/Today Note/Sender Email Address\|SOC/Notes/Today Note/Sender Email Address]]
- [ ] [[SOC/Notes/Today Note/Subject Line\|SOC/Notes/Today Note/Subject Line]]
- [ ] [[SOC/Notes/Today Note/Recipient Email Addresses\|SOC/Notes/Today Note/Recipient Email Addresses]] (Unless they're in Blind Carbon Copy (BCC))
- [ ] [[SOC/Notes/Today Note/Date & Time\|SOC/Notes/Today Note/Date & Time]]
## Text Editor Extraction (Sublime)
- [ ] [[SOC/Notes/Today Note/Sending Server IP & Reverse DNS\|SOC/Notes/Today Note/Sending Server IP & Reverse DNS]] 
- [ ] [[SOC/Notes/Today Note/Reply To Address\|SOC/Notes/Today Note/Reply To Address]]

## File Artifacts 
 [[SOC/Notes/Today Note/Attachment Name.Extension\|SOC/Notes/Today Note/Attachment Name.Extension]] - The attachment name can be blocked using an organization's Endpoint Detection and Response (EDR) platform if the name is unique.
 
- [ ]  [[SOC/Notes/Today Note/SHA256 Hash Value\|SOC/Notes/Today Note/SHA256 Hash Value]]

## Web Artifacts 
- [ ] [[SOC/Notes/Today Note/Full URLs\|SOC/Notes/Today Note/Full URLs]]
**Root Domain** - To check if the site is legitimate and has not been compromised.

## Automated Collection with PhishTool
[PhishTool](https://www.phishtool.com/)

Basic Header:
- Sending Address
- Subject Line
- Recipients
- Date + Time
Detailed Header:
- Sending Server IP
- Reverse DNS
URLs
Attachments



# 4. Investigate malicious artifacts to collect indicators of compromise that can be blocked to protect the organization
## URL Visualization Tools
[URL2PNG - Screenshots as a Service](https://www.url2png.com/#testdrive)
![SOC/Notes/Today Note/{CBB3FDE2-CEC0-460B-BD14-4A64BE990536}.png](/img/user/SOC/Notes/Today%20Note/%7BCBB3FDE2-CEC0-460B-BD14-4A64BE990536%7D.png)

[URL and website scanner - urlscan.io](https://urlscan.io/)
![SOC/Notes/Today Note/{54311C61-8C32-48A5-A867-103350E14756}.png](/img/user/SOC/Notes/Today%20Note/%7B54311C61-8C32-48A5-A867-103350E14756%7D.png)
## URL Reputation Tools
[VirusTotal - Home](https://www.virustotal.com/gui/home/url)
![SOC/Notes/Today Note/{2F12DD9B-3BCE-4856-9FAC-90AA2C5D0ABC}.png](/img/user/SOC/Notes/Today%20Note/%7B2F12DD9B-3BCE-4856-9FAC-90AA2C5D0ABC%7D.png)

![SOC/Notes/Today Note/{9EB2A925-FFDA-4180-8CAE-D632C4E1C3EA}.png](/img/user/SOC/Notes/Today%20Note/%7B9EB2A925-FFDA-4180-8CAE-D632C4E1C3EA%7D.png)
## Threat Feeds
[URLhaus | Browse](https://urlhaus.abuse.ch/browse/)
![SOC/Notes/Today Note/{2EF31E5D-9626-411E-9445-3386FEF72184}.png](/img/user/SOC/Notes/Today%20Note/%7B2EF31E5D-9626-411E-9445-3386FEF72184%7D.png)

You can proactively block malicious sites using `CSV` files from [URLhaus | Feeds](https://urlhaus.abuse.ch/feeds/)
![SOC/Notes/Today Note/{3D579707-5BE1-43FA-A52B-422A031C81CD}.png](/img/user/SOC/Notes/Today%20Note/%7B3D579707-5BE1-43FA-A52B-422A031C81CD%7D.png)

[PhishTank | Join the fight against phishing](https://www.phishtank.com/)
![SOC/Notes/Today Note/{44CE3066-C1EF-4FFC-86FE-EF9E995073F2}.png](/img/user/SOC/Notes/Today%20Note/%7B44CE3066-C1EF-4FFC-86FE-EF9E995073F2%7D.png)

## File Reputation Tools
[VirusTotal - Home](https://www.virustotal.com/gui/home/upload)
![SOC/Notes/Today Note/{1DA876E3-C93C-4FD6-9606-25AA56822F3A}.png](/img/user/SOC/Notes/Today%20Note/%7B1DA876E3-C93C-4FD6-9606-25AA56822F3A%7D.png)

Use the SHA256 hash to check file reputation with [Talos File Reputation Lookup || Cisco Talos Intelligence Group - Comprehensive Threat Intelligence](https://talosintelligence.com/talos_file_reputation)
![SOC/Notes/Today Note/{0B8FCBE2-EC66-4F85-BC21-09DA4D708ABF}.png](/img/user/SOC/Notes/Today%20Note/%7B0B8FCBE2-EC66-4F85-BC21-09DA4D708ABF%7D.png)

## Automated Malware Analysis
[Free Automated Malware Analysis Service - powered by Falcon Sandbox](https://www.hybrid-analysis.com/#homepage-file-collection)
![SOC/Notes/Today Note/{5A034FD2-AE9A-4936-91E7-A07060CF2C38}.png](/img/user/SOC/Notes/Today%20Note/%7B5A034FD2-AE9A-4936-91E7-A07060CF2C38%7D.png)


# 5. Taking Defensive Actions

## Preventative

 >[!Important] Security Awareness Training
>```
>The first thing that should be done to prevent phishing attacks is user awareness training.
>To check if the user awareness training worked I suggest using a simulated phishing attack platforms. Some great ones include Sophos Phish Threat, GoPhish Open-Source, Trend Micro’s Phish Insight, and PhishingBox.
>```

> [!important] Marking External Emails
>```
>A way to prevent the phishing attack that took place is to apply a rule where any email coming from an external email into the organization has the subject line appended with a message such as external.
>```
[[SOC/Notes/Today Note/Write/Defensive Measures#How to mark External Emails GUI\|SOC/Notes/Today Note/Write/Defensive Measures#How to mark External Emails GUI]]

> [!important] Malicious Email Attachments
>  ```
>  To decrease the attack surface for malicious attachments, an organization should implement attachment filtering for file types that are not regularly used. For all other file types, an attachment sandbox should be employed, ensuring that the file is run and monitored in a virtualized environment before execution on a user machine.
>  ```

> [!important] Filtering Spam
> An organization can use the following technologies for Spam Filtering:
>  - **Content Filters** which uses information in the header and/or body and can compare it to published blacklists or known spamming networks and automatically classify it as spam.
>  
>  - **Rule-Based Filters** uses a predetermined rule to determine if the email is legitimate or not. This predetermined rule can be something as simple as looking for a word or phrase inside the email header or body.
>  
>  - **Bayesian Filters** is the most intelligent type of spam filter that can use machine learning to learn user spam preferences. When a user marks a message as spam a Bayesian filter will mark all future emails similar spam. A downside is it requires a large amount of spam to utilize the machine learning capabilities.


### Email Security Technology

> [!important] Protecting Your Domain from Spoofing
> The DNS (TXT) record Sender Policy Framework (SPF) can be used to to prevent a malicious actor from spoofing your domain.
> 
> Syntax of SPF:
> `v=spf1 <IP> <enforcement rule>`
> Example:
> `v=spf1 a: include:mailgun.org protection.outlook.com -all`

> [!important] Domain Keys Identified Mail (DKIM)
> Domain Keys Identified Mail (DKIM) is a method of email authentication that cryptographically verifies if an email has been sent by its trusted servers and hasn’t been tampered with during transmission.


> [!important] DMARC specify what happens if both SPF and DMARC checks are failed
> Domain-based Message Authentication, Reporting & Conformance can be used to specify what happens when both SPF and DKIM checks are failed.
> The three basic options is none, quarantine, and reject
> 
> Syntax:
> `v=DMARC1 <action> <report address>`
>
>Example:
>`v=DMARC1; p=quarantine; rua=mailto:contact@securityblue.team`




## Reactive


> [!important] Blocking Email Artifacts
> You can block the following email artifacts:
> - Email Sender 
> - Sender Domain (block the entire sending domain if necessary)
> - Sender Server IP
> - Subject Line

### Blocking Web Artifacts

> [!important] URL Blocks
> 


# 6. Complete the investigation report, documenting all of the above steps



</div></div>
","id":"1ce1aca6-8f48-d102","main":false,"useEditMode":true,"x":0,"y":0,"stroke":"#283593","layout":{"layoutName":"mindmap2","direct":"mindmap"},"isExpand":true,"style":{"background-color":"#AD1457","color":"#fff","border-color":"#AD1457","border-width":0,"padding":[9,14,8,14],"font-size":"14","stroke":"#283593"}}]],"induceData":[],"wireFrameData":[{"stroke":"rgb(42,122,194)","fill":"rgba(213,233,252,.1)","lineDash":[6,2],"data":{"text":"You can gather all this information by using a automated collection tool such as https://www.phishtool.com/","nodeType":"wireFrame"},"radius":10,"lineWidth":1,"nodeId":"94e31d63-f228-ec6f","endNodeId":"57273714-1811-208a","range":"0,1","nodeData":{"id":"2af876b4-d815-18b2","text":"You can gather all this information by using a automated collection tool such as https://www.phishtool.com/","nodeType":"wireFrame","style":{"padding-left":6,"padding-right":6,"padding-bottom":4,"padding-top":4,"background-color":"orange","color":"#333","fontSize":12,"border-color":"orange","font-size":"12"},"x":0,"y":-76864,"layout":null,"isExpand":true,"stroke":"","note":"A way to prevent the phishing attack that took place is to apply a rule where any email coming from an external email into the organization has the subject line appended with a message such as external."},"text":"You can gather all this information by using a automated collection tool such as https://www.phishtool.com/"},{"stroke":"rgb(42,122,194)","fill":"rgba(213,233,252,.1)","lineDash":[6,2],"data":{"text":"Take note if email is or is not marked as external as this is a preventative measure.\nYou can mark external emails by following [[Defensive Measures#How to mark External Emails GUI]]","nodeType":"wireFrame"},"radius":10,"lineWidth":1,"nodeId":"dbf02f17-ca8e-24d6","endNodeId":"c1febe46-6d0b-5199","range":"0,3","nodeData":{"id":"3014c72c-e7d6-b808","text":"Take note if email is or is not marked as external as this is a preventative measure.\nYou can mark external emails by following [[Defensive Measures#How to mark External Emails GUI]]","nodeType":"wireFrame","style":{"padding-left":6,"padding-right":6,"padding-bottom":4,"padding-top":4,"background-color":"orange","color":"#333","fontSize":12,"font-size":"12"},"x":0,"y":-76895,"layout":null,"isExpand":true,"stroke":""},"text":"Take note if email is or is not marked as external as this is a preventative measure.\nYou can mark external emails by following [[Defensive Measures#How to mark External Emails GUI]]"},{"stroke":"rgb(42,122,194)","fill":"rgba(213,233,252,.1)","lineDash":[6,2],"data":{"text":"You can proactively block malicious sites using a csv file from https://urlhaus.abuse.ch/feeds/","nodeType":"wireFrame"},"radius":10,"lineWidth":1,"nodeId":"5ae1f6eb-6aec-edaf","endNodeId":"5ae1f6eb-6aec-edaf","range":"2,2","nodeData":{"id":"e23bd7d6-1b21-47f4","text":"You can proactively block malicious sites using a csv file from https://urlhaus.abuse.ch/feeds/","nodeType":"wireFrame","style":{"padding-left":6,"padding-right":6,"padding-bottom":4,"padding-top":4,"background-color":"orange","color":"#333","fontSize":12,"border-color":"orange","font-size":"12"},"x":0,"y":-76864,"layout":null,"isExpand":true,"stroke":""},"text":"You can proactively block malicious sites using a csv file from https://urlhaus.abuse.ch/feeds/"},{"stroke":"rgb(42,122,194)","fill":"rgba(213,233,252,.1)","lineDash":[6,2],"data":{"text":"https://urlscan.io/ can be used for both","nodeType":"wireFrame"},"radius":10,"lineWidth":1,"nodeId":"a57130f4-6901-d57c","endNodeId":"686efc67-f389-764d","range":"0,1","nodeData":{"id":"ff122b15-0502-4bf3","text":"https://urlscan.io/ can be used for both","nodeType":"wireFrame","style":{"padding-left":6,"padding-right":6,"padding-bottom":4,"padding-top":4,"background-color":"orange","color":"#333","fontSize":12,"font-size":"12"},"x":0,"y":-76853,"layout":null,"isExpand":true,"stroke":""},"text":"https://urlscan.io/ can be used for both"},{"stroke":"rgb(42,122,194)","fill":"rgba(213,233,252,.1)","lineDash":[6,2],"data":{"text":"Preventative Measure - User Awareness Training and Spam Filtering","nodeType":"wireFrame"},"radius":10,"lineWidth":1,"nodeId":"294d04a4-67c0-2d66","endNodeId":"90a0e143-dbed-79dc","range":"0,5","nodeData":{"id":"c6fe4709-917c-0072","text":"Preventative Measure - User Awareness Training and Spam Filtering","nodeType":"wireFrame","style":{"padding-left":6,"padding-right":6,"padding-bottom":4,"padding-top":4,"background-color":"orange","color":"#333","fontSize":12,"font-size":"14"},"x":-5,"y":-76941,"note":">[!Important] Security Awareness Training\n>The first thing that should be done to prevent phishing attacks is user awareness training.\n>To check if the user awareness training worked I suggest using a simulated phishing attack platforms. Some great ones include Sophos Phish Threat, GoPhish Open-Source, Trend Micro’s Phish Insight, and PhishingBox.\n\n\n> [!important] Filtering Spam\n> An organization can use the following technologies for Spam Filtering:\n>  - **Content Filters** which uses information in the header and/or body and can compare it to published blacklists or known spamming networks and automatically classify it as spam.\n>  \n>  - **Rule-Based Filters** uses a predetermined rule to determine if the email is legitimate or not. This predetermined rule can be something as simple as looking for a word or phrase inside the email header or body.\n>  \n>  - **Bayesian Filters** is the most intelligent type of spam filter that can use machine learning to learn user spam preferences. When a user marks a message as spam a Bayesian filter will mark all future emails similar spam. A downside is it requires a large amount of spam to utilize the machine learning capabilities.\n","layout":null,"isExpand":true,"stroke":""},"text":"Preventative Measure - User Awareness Training and Spam Filtering"},{"stroke":"rgb(42,122,194)","fill":"rgba(213,233,252,.1)","lineDash":[6,2],"data":{"text":"Preventative Measure - Implement attachment filtering for file types that are not regularly used","nodeType":"wireFrame"},"radius":10,"lineWidth":1,"nodeId":"da69ff43-fd5e-42d4","endNodeId":"b70ee5ed-4a45-e905","range":"0,1","nodeData":{"id":"2e7d890e-c285-dff4","text":"Preventative Measure - Implement attachment filtering for file types that are not regularly used","nodeType":"wireFrame","style":{"padding-left":6,"padding-right":6,"padding-bottom":4,"padding-top":4,"background-color":"orange","color":"#333","fontSize":12,"font-size":"12","font-weight":""},"x":-5,"y":-76905,"note":"To decrease the attack surface for malicious attachments, an organization should implement attachment filtering for file types that are not regularly used. For all other file types, an attachment sandbox should be employed, ensuring that the file is run and monitored in a virtualized environment before execution on a user machine.","layout":null,"isExpand":true,"stroke":""},"text":"Preventative Measure - Implement attachment filtering for file types that are not regularly used"},{"stroke":"rgb(42,122,194)","fill":"rgba(213,233,252,.1)","lineDash":[6,2],"data":{"text":"Additional Preventative","nodeType":"wireFrame"},"radius":10,"lineWidth":1,"nodeId":"cdabc236-067b-ca1e","endNodeId":"8b429c4a-367e-de04","range":"0,2","nodeData":{"id":"0a911b18-35ed-ca02","text":"Additional Preventative","nodeType":"wireFrame","style":{"padding-left":6,"padding-right":6,"padding-bottom":4,"padding-top":4,"background-color":"rgb(16, 151, 232)","color":"#333","fontSize":12},"x":0,"y":-76854,"layout":null,"isExpand":true,"stroke":""},"text":"Additional Preventative"},{"stroke":"rgb(42,122,194)","fill":"rgba(213,233,252,.1)","lineDash":[6,2],"data":{"text":"Reactive","nodeType":"wireFrame"},"radius":10,"lineWidth":1,"nodeId":"c39b4971-0a05-c9db","endNodeId":"c460294d-5312-581e","range":"3,4","nodeData":{"id":"a1c5d204-4662-2987","text":"Reactive","nodeType":"wireFrame","style":{"padding-left":6,"padding-right":6,"padding-bottom":4,"padding-top":4,"background-color":"rgb(16, 151, 232)","color":"#333","fontSize":12},"x":0,"y":-76854,"layout":null,"isExpand":true,"stroke":""},"text":"Reactive"},{"stroke":"rgb(42,122,194)","fill":"rgba(213,233,252,.1)","lineDash":[6,2],"data":{"text":"Logon/Logoff","nodeType":"wireFrame"},"radius":10,"lineWidth":1,"nodeId":"f011c1aa-653e-80ed","endNodeId":"5a8f092d-31c5-1785","range":"0,6","nodeData":{"id":"1f20e9c2-f812-8a95","text":"Logon/Logoff","nodeType":"wireFrame","style":{"padding-left":6,"padding-right":6,"padding-bottom":4,"padding-top":4,"background-color":"orange","color":"#333","fontSize":12},"x":149948,"y":148611,"layout":null,"isExpand":true,"stroke":""},"text":"Logon/Logoff"},{"stroke":"rgb(42,122,194)","fill":"rgba(213,233,252,.1)","lineDash":[6,2],"data":{"text":"Evading Detection","nodeType":"wireFrame"},"radius":10,"lineWidth":1,"nodeId":"887bfb1f-5daa-2140","endNodeId":"97230258-36c3-d89e","range":"13,14","nodeData":{"id":"b50cc3e3-a29a-22ff","text":"Evading Detection","nodeType":"wireFrame","style":{"padding-left":6,"padding-right":6,"padding-bottom":4,"padding-top":4,"background-color":"orange","color":"#333","fontSize":12},"x":149948,"y":149150,"layout":null,"isExpand":true,"stroke":""},"text":"Evading Detection"},{"stroke":"rgb(42,122,194)","fill":"rgba(213,233,252,.1)","lineDash":[6,2],"data":{"text":"Persistence","nodeType":"wireFrame"},"radius":10,"lineWidth":1,"nodeId":"89fa996d-9c89-c106","endNodeId":"80c30d87-c12c-bb26","range":"7,12","nodeData":{"id":"ec585a0c-77ca-6c09","text":"Persistence","nodeType":"wireFrame","style":{"padding-left":6,"padding-right":6,"padding-bottom":4,"padding-top":4,"background-color":"orange","color":"#333","fontSize":12},"x":149942.5,"y":148876,"layout":null,"isExpand":true,"stroke":""},"text":"Persistence"},{"stroke":"rgb(42,122,194)","fill":"rgba(213,233,252,.1)","lineDash":[6,2],"data":{"text":"Lateral Movement","nodeType":"wireFrame"},"radius":10,"lineWidth":1,"nodeId":"8c1ba57e-a59b-8047","endNodeId":"8c1ba57e-a59b-8047","range":"15,15","nodeData":{"id":"f1b707d9-d56e-cb55","text":"Lateral Movement","nodeType":"wireFrame","style":{"padding-left":6,"padding-right":6,"padding-bottom":4,"padding-top":4,"background-color":"orange","color":"#333","fontSize":12},"x":149948,"y":149255,"layout":null,"isExpand":true,"stroke":""},"text":"Lateral Movement"},{"stroke":"rgb(42,122,194)","fill":"rgba(213,233,252,.1)","lineDash":[6,2],"data":{"text":"Accessing Sensitive Resources","nodeType":"wireFrame"},"radius":10,"lineWidth":1,"nodeId":"a3010bce-3489-04a5","endNodeId":"8c4ccc96-d1d1-bdbf","range":"16,17","nodeData":{"id":"2da0a9df-ca4b-a571","text":"Accessing Sensitive Resources","nodeType":"wireFrame","style":{"padding-left":6,"padding-right":6,"padding-bottom":4,"padding-top":4,"background-color":"orange","color":"#333","fontSize":12},"x":149948,"y":149328,"layout":null,"isExpand":true,"stroke":""},"text":"Accessing Sensitive Resources"},{"stroke":"rgb(42,122,194)","fill":"rgba(213,233,252,.1)","lineDash":[6,2],"data":{"text":"Running Malicious Code","nodeType":"wireFrame"},"radius":10,"lineWidth":1,"nodeId":"e987bea7-0cba-1b93","endNodeId":"80c30d87-c12c-bb26","range":"11,12","nodeData":{"id":"fd717191-0dc2-3f97","text":"Running Malicious Code","nodeType":"wireFrame","style":{"padding-left":6,"padding-right":6,"padding-bottom":4,"padding-top":4,"background-color":"orange","color":"#333","fontSize":12},"x":149948,"y":149039,"layout":null,"isExpand":true,"stroke":""},"text":"Running Malicious Code"},{"stroke":"rgb(42,122,194)","fill":"rgba(213,233,252,.1)","lineDash":[6,2],"data":{"text":"Account Takeover or Insider Threat","nodeType":"wireFrame"},"radius":10,"lineWidth":1,"nodeId":"3d5e6901-3513-0eda","endNodeId":"3d5e6901-3513-0eda","range":"18,18","nodeData":{"id":"98a57aa1-fdf8-cace","text":"Account Takeover or Insider Threat","nodeType":"wireFrame","style":{"padding-left":6,"padding-right":6,"padding-bottom":4,"padding-top":4,"background-color":"orange","color":"#333","fontSize":12},"x":149948,"y":149433,"layout":null,"isExpand":true,"stroke":""},"text":"Account Takeover or Insider Threat"},{"stroke":"rgb(42,122,194)","fill":"rgba(213,233,252,.1)","lineDash":[6,2],"data":{"text":"Exfiltrating Data","nodeType":"wireFrame"},"radius":10,"lineWidth":1,"nodeId":"80245d58-4637-cd24","endNodeId":"80245d58-4637-cd24","range":"19,19","nodeData":{"id":"e9e254ba-6dc5-f417","text":"Exfiltrating Data","nodeType":"wireFrame","style":{"padding-left":6,"padding-right":6,"padding-bottom":4,"padding-top":4,"background-color":"orange","color":"#333","fontSize":12},"x":149948,"y":149611,"layout":null,"isExpand":true,"stroke":""},"text":"Exfiltrating Data"},{"stroke":"rgb(42,122,194)","fill":"rgba(213,233,252,.1)","lineDash":[6,2],"data":{"text":"Network Mapping","nodeType":"wireFrame"},"radius":10,"lineWidth":1,"nodeId":"cba48793-fa68-3d2a","endNodeId":"cba48793-fa68-3d2a","range":"20,20","nodeData":{"id":"7b7c800c-033f-1319","text":"Network Mapping","nodeType":"wireFrame","style":{"padding-left":6,"padding-right":6,"padding-bottom":4,"padding-top":4,"background-color":"orange","color":"#333","fontSize":12},"x":149948,"y":149684,"layout":null,"isExpand":true,"stroke":""},"text":"Network Mapping"},{"stroke":"rgb(42,122,194)","fill":"rgba(213,233,252,.1)","lineDash":[6,2],"data":{"text":"Identification of Malicious Traffic","nodeType":"wireFrame"},"radius":10,"lineWidth":1,"nodeId":"543fd1af-40de-b665","endNodeId":"543fd1af-40de-b665","range":"21,21","nodeData":{"id":"80f9a46b-1ed1-5d63","text":"Identification of Malicious Traffic","nodeType":"wireFrame","style":{"padding-left":6,"padding-right":6,"padding-bottom":4,"padding-top":4,"background-color":"orange","color":"#333","fontSize":12},"x":149948,"y":149768,"layout":null,"isExpand":true,"stroke":""},"text":"Identification of Malicious Traffic"},{"stroke":"rgb(42,122,194)","fill":"rgba(213,233,252,.1)","lineDash":[6,2],"data":{"text":"Identification of Malware","nodeType":"wireFrame"},"radius":10,"lineWidth":1,"nodeId":"5a17ad15-c281-0e3e","endNodeId":"4e653cfb-0a47-03ab","range":"22,23","nodeData":{"id":"2d680d36-2ab7-ef5d","text":"Identification of Malware","nodeType":"wireFrame","style":{"padding-left":6,"padding-right":6,"padding-bottom":4,"padding-top":4,"background-color":"orange","color":"#333","fontSize":12},"x":149948,"y":149841,"layout":null,"isExpand":true,"stroke":""},"text":"Identification of Malware"}],"relateLinkData":[],"calloutData":[{"nodeId":"80245d58-4637-cd24","rootData":{"id":"9d5597ac-a0cd-0418","text":"Also can suggest the spreading of malware","nodeType":"callout","style":{"background-color":"#f06","color":"#fff","font-size":"12"},"x":150075,"y":150144,"layout":null,"isExpand":true,"stroke":"","point":{"x":150106.75,"y":150186},"box":{"dx":0.508,"dy":-1.75,"px":0.635,"py":0}},"color":"#f06","direct":"top"}],"opt":{"background":"#D7CCC8","fontFamily":"","fontSize":16}}
```


### node element start

Memory (RAM) Analysis with Volatility
[[SOC/Digital Forensic Notes/Digital Forensics#Volatility]]
{ #479d51bd-8abc-b399}


Refer to [[Report Writing#Basic Report Writing Template]]
{ #e322decd-d0a4-58ea}


Refer to [[SOC/Notes/3-3-2025/SHA256 Hash Value]]
{ #72f8bf33-7cdc-95fd}


Kape
[[SOC/Digital Forensic Notes/Digital Forensics#Live Forensics W/ KAPE]]
{ #c3d9d982-344c-e440}


Single process with PowerShell
(Should be used for malware)
[[SOC/Digital Forensic Notes/Digital Forensics#Powershell process memory dump]]
{ #9f6a545b-d765-e89e}


Recycle Bin Metadata Recovery
[[SOC/Digital Forensic Notes/Digital Forensics#Recycle Bin Metadata recovery]]
{ #60413a4d-89d9-aa3e}


Users and Passwords (/etc/passwd and /etc/shadow)
[[SOC/Digital Forensic Notes/Digital Forensics#Passwd and Shadow]]
{ #44c44ba1-ac87-191f}


Currently installed software packages (/var/lib)
[[SOC/Digital Forensic Notes/Digital Forensics#var/lib]]
{ #894d3a9c-c231-48de}


Memory Dump
[[SOC/Digital Forensic Notes/Digital Forensics#Memory]]
{ #976bfa32-8480-fa30}


Setup
[[Autopsy#Setup]]
{ #a08c0c26-9362-457f}


Security Logs
[[Event log locations]]
{ #0ee021ff-1865-3e84}


syslog message explanation
[[syslog message]]
{ #0626f76d-d8ed-2604}


LNK Files / Shortcut Analysis
[[SOC/Digital Forensic Notes/Digital Forensics#LNK Files / Shortcut Analysis]]
{ #2029d2f4-8cd3-7fdf}


**Prefetch Files** - Path to the executable file, when the program was last run, and when the program was created/installed.
[[SOC/Digital Forensic Notes/Digital Forensics#Prefetch Files]]
{ #07967149-2dc8-01a6}


**Jump List** - Contain information about applications that are pinned to the taskbar, such as the file path, timestamps, and application identifiers (AppIDs).
[[SOC/Digital Forensic Notes/Digital Forensics#Jump List]]
{ #e4891168-9a26-0fa4}


Browser Viewer w/ Browser History Viewer
[[SOC/Digital Forensic Notes/Digital Forensics#Browser History Viewer]]
{ #d8373ca9-98f9-57b6}


Operating System Logs
[[SOC/Digital Forensic Notes/Digital Forensics#var/log]]
{ #15656c8e-f65f-4a85}


Web Server Logs
[[SOC/Digital Forensic Notes/Digital Forensics#Web Server Logs]]
{ #04d0ca45-9518-fb62}


.bash_history
[[SOC/Digital Forensic Notes/Digital Forensics#Bash History]]
{ #303acd45-de5d-8a5a}


Steganography
[[SOC/Digital Forensic Notes/Digital Forensics#Steganography]]
{ #94467738-74d4-3306}


[[4634]] (Logoff)
{ #f011c1aa-653e-80ed}


[[4624]] (Successful Logon)
{ #0a61536a-3e02-fdb9}


To identify whether the phishing email was spoofed.
In text editor CTRL + F **X-Sender-IP**
After go to [[SOC/Notes/3-3-2025/Sending Server IP & Reverse DNS]] to get instructions
for performing a reverse DNS lookup
{ #11132cbb-32cb-3a35}


Compute the sha256, sha1, and md5 hash of the attachment
[[SOC/Notes/3-3-2025/SHA256 Hash Value]]
{ #1db6760d-cfde-876d}


On text editor the three quickest ways to
find URL(s) is [[SOC/Notes/Today Note/Full URLs]]
{ #db93939b-e51b-6e58}



<div class="transclusion internal-embed is-loaded"><div class="markdown-embed">



1. **Retrieve an original copy of the phishing email**
2. [[Phishing Emails and Artifact Analysis#2. Gather artifacts from the phishing email|Gather Artifacts from the phishing email]]
3. **Inform the recipients that received the email**
4. [[Phishing Emails and Artifact Analysis#4. Investigate malicious artifacts to collect indicators of compromise that can be blocked to protect the organization|Investigate malicious artifacts to collect indicators of compromise that can be blocked to protect the organization]] 
5. [[Phishing Emails and Artifact Analysis#5. Taking Defensive Actions|Take Defensive Actions]]
6. [[Phishing Emails and Artifact Analysis#6. Complete the investigation report, documenting all of the above steps|Complete the investigation report, documenting all of the above steps]]

# 2. Gather artifacts from the phishing email

>[!Important]
>The first thing that should be done to prevent phishing attacks is user awareness training.
>
>When a organization is mature enough they can start [[Simulating Phishing Attacks]]
## Email Client Extraction

> [!important] Preventative / Defensive Measure
> If the email is not marked as external at this step then a Preventative/Defensive Measure will be to ensure all external emails should be marked as external using [[SOC/Notes/Today Note/Write/Defensive Measures#How to mark External Emails GUI]]

- [ ] [[SOC/Notes/Today Note/Sender Email Address]]
- [ ] [[SOC/Notes/Today Note/Subject Line]]
- [ ] [[SOC/Notes/Today Note/Recipient Email Addresses]] (Unless they're in Blind Carbon Copy (BCC))
- [ ] [[SOC/Notes/Today Note/Date & Time]]
## Text Editor Extraction (Sublime)
- [ ] [[SOC/Notes/Today Note/Sending Server IP & Reverse DNS]] 
- [ ] [[SOC/Notes/Today Note/Reply To Address]]

## File Artifacts 
 [[SOC/Notes/Today Note/Attachment Name.Extension]] - The attachment name can be blocked using an organization's Endpoint Detection and Response (EDR) platform if the name is unique.
 
- [ ]  [[SOC/Notes/Today Note/SHA256 Hash Value]]

## Web Artifacts 
- [ ] [[SOC/Notes/Today Note/Full URLs]]
**Root Domain** - To check if the site is legitimate and has not been compromised.

## Automated Collection with PhishTool
[PhishTool](https://www.phishtool.com/)

Basic Header:
- Sending Address
- Subject Line
- Recipients
- Date + Time
Detailed Header:
- Sending Server IP
- Reverse DNS
URLs
Attachments



# 4. Investigate malicious artifacts to collect indicators of compromise that can be blocked to protect the organization
## URL Visualization Tools
[URL2PNG - Screenshots as a Service](https://www.url2png.com/#testdrive)
![SOC/Notes/Today Note/{CBB3FDE2-CEC0-460B-BD14-4A64BE990536}.png](/img/user/SOC/Notes/Today%20Note/%7BCBB3FDE2-CEC0-460B-BD14-4A64BE990536%7D.png)

[URL and website scanner - urlscan.io](https://urlscan.io/)
![SOC/Notes/Today Note/{54311C61-8C32-48A5-A867-103350E14756}.png](/img/user/SOC/Notes/Today%20Note/%7B54311C61-8C32-48A5-A867-103350E14756%7D.png)
## URL Reputation Tools
[VirusTotal - Home](https://www.virustotal.com/gui/home/url)
![SOC/Notes/Today Note/{2F12DD9B-3BCE-4856-9FAC-90AA2C5D0ABC}.png](/img/user/SOC/Notes/Today%20Note/%7B2F12DD9B-3BCE-4856-9FAC-90AA2C5D0ABC%7D.png)

![SOC/Notes/Today Note/{9EB2A925-FFDA-4180-8CAE-D632C4E1C3EA}.png](/img/user/SOC/Notes/Today%20Note/%7B9EB2A925-FFDA-4180-8CAE-D632C4E1C3EA%7D.png)
## Threat Feeds
[URLhaus | Browse](https://urlhaus.abuse.ch/browse/)
![SOC/Notes/Today Note/{2EF31E5D-9626-411E-9445-3386FEF72184}.png](/img/user/SOC/Notes/Today%20Note/%7B2EF31E5D-9626-411E-9445-3386FEF72184%7D.png)

You can proactively block malicious sites using `CSV` files from [URLhaus | Feeds](https://urlhaus.abuse.ch/feeds/)
![SOC/Notes/Today Note/{3D579707-5BE1-43FA-A52B-422A031C81CD}.png](/img/user/SOC/Notes/Today%20Note/%7B3D579707-5BE1-43FA-A52B-422A031C81CD%7D.png)

[PhishTank | Join the fight against phishing](https://www.phishtank.com/)
![SOC/Notes/Today Note/{44CE3066-C1EF-4FFC-86FE-EF9E995073F2}.png](/img/user/SOC/Notes/Today%20Note/%7B44CE3066-C1EF-4FFC-86FE-EF9E995073F2%7D.png)

## File Reputation Tools
[VirusTotal - Home](https://www.virustotal.com/gui/home/upload)
![SOC/Notes/Today Note/{1DA876E3-C93C-4FD6-9606-25AA56822F3A}.png](/img/user/SOC/Notes/Today%20Note/%7B1DA876E3-C93C-4FD6-9606-25AA56822F3A%7D.png)

Use the SHA256 hash to check file reputation with [Talos File Reputation Lookup || Cisco Talos Intelligence Group - Comprehensive Threat Intelligence](https://talosintelligence.com/talos_file_reputation)
![SOC/Notes/Today Note/{0B8FCBE2-EC66-4F85-BC21-09DA4D708ABF}.png](/img/user/SOC/Notes/Today%20Note/%7B0B8FCBE2-EC66-4F85-BC21-09DA4D708ABF%7D.png)

## Automated Malware Analysis
[Free Automated Malware Analysis Service - powered by Falcon Sandbox](https://www.hybrid-analysis.com/#homepage-file-collection)
![SOC/Notes/Today Note/{5A034FD2-AE9A-4936-91E7-A07060CF2C38}.png](/img/user/SOC/Notes/Today%20Note/%7B5A034FD2-AE9A-4936-91E7-A07060CF2C38%7D.png)


# 5. Taking Defensive Actions

## Preventative

 >[!Important] Security Awareness Training
>```
>The first thing that should be done to prevent phishing attacks is user awareness training.
>To check if the user awareness training worked I suggest using a simulated phishing attack platforms. Some great ones include Sophos Phish Threat, GoPhish Open-Source, Trend Micro’s Phish Insight, and PhishingBox.
>```

> [!important] Marking External Emails
>```
>A way to prevent the phishing attack that took place is to apply a rule where any email coming from an external email into the organization has the subject line appended with a message such as external.
>```
[[SOC/Notes/Today Note/Write/Defensive Measures#How to mark External Emails GUI]]

> [!important] Malicious Email Attachments
>  ```
>  To decrease the attack surface for malicious attachments, an organization should implement attachment filtering for file types that are not regularly used. For all other file types, an attachment sandbox should be employed, ensuring that the file is run and monitored in a virtualized environment before execution on a user machine.
>  ```

> [!important] Filtering Spam
> An organization can use the following technologies for Spam Filtering:
>  - **Content Filters** which uses information in the header and/or body and can compare it to published blacklists or known spamming networks and automatically classify it as spam.
>  
>  - **Rule-Based Filters** uses a predetermined rule to determine if the email is legitimate or not. This predetermined rule can be something as simple as looking for a word or phrase inside the email header or body.
>  
>  - **Bayesian Filters** is the most intelligent type of spam filter that can use machine learning to learn user spam preferences. When a user marks a message as spam a Bayesian filter will mark all future emails similar spam. A downside is it requires a large amount of spam to utilize the machine learning capabilities.


### Email Security Technology

> [!important] Protecting Your Domain from Spoofing
> The DNS (TXT) record Sender Policy Framework (SPF) can be used to to prevent a malicious actor from spoofing your domain.
> 
> Syntax of SPF:
> `v=spf1 <IP> <enforcement rule>`
> Example:
> `v=spf1 a: include:mailgun.org protection.outlook.com -all`

> [!important] Domain Keys Identified Mail (DKIM)
> Domain Keys Identified Mail (DKIM) is a method of email authentication that cryptographically verifies if an email has been sent by its trusted servers and hasn’t been tampered with during transmission.


> [!important] DMARC specify what happens if both SPF and DMARC checks are failed
> Domain-based Message Authentication, Reporting & Conformance can be used to specify what happens when both SPF and DKIM checks are failed.
> The three basic options is none, quarantine, and reject
> 
> Syntax:
> `v=DMARC1 <action> <report address>`
>
>Example:
>`v=DMARC1; p=quarantine; rua=mailto:contact@securityblue.team`




## Reactive


> [!important] Blocking Email Artifacts
> You can block the following email artifacts:
> - Email Sender 
> - Sender Domain (block the entire sending domain if necessary)
> - Sender Server IP
> - Subject Line

### Blocking Web Artifacts

> [!important] URL Blocks
> 


# 6. Complete the investigation report, documenting all of the above steps



</div></div>

{ #1ce1aca6-8f48-d102}


### node element end